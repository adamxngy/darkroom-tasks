{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
    <h2 class="h4 mb-0" id="project-detail-title">{{ project.name }}</h2>
    <div class="text-secondary small" id="project-detail-subtitle">Status: <span id="project-detail-status">{{ project.status }}</span></div>
  </div>
  <a href="{{ url_for('project_edit', project_id=project.id) }}" class="btn btn-outline-light" id="btn-project-edit">Edit Project</a>
</div>

<div class="row g-4">
  <div class="col-lg-6">
    <div class="card bg-black border-secondary h-100">
      <div class="card-body">
        <h3 class="h5" id="tasks-title">Tasks</h3>
        <ul class="list-group list-group-flush" id="task-list">
          {% for t in tasks %}
          <li class="list-group-item bg-black text-light d-flex align-items-start gap-2" id="task-item-{{ t.id }}">
            <input class="form-check-input mt-1" type="checkbox" id="task-done-{{ t.id }}" {% if t.done %}checked{% endif %} onclick="toggleTask({{ t.id }})">
            <div class="flex-grow-1">
              <div class="d-flex justify-content-between">
                <strong id="task-title-{{ t.id }}">{{ t.title }}</strong>
                <span class="badge text-bg-secondary" id="task-priority-{{ t.id }}">{{ t.priority }}</span>
              </div>
              <div class="small text-secondary" id="task-details-{{ t.id }}">{{ t.details or '' }}</div>
            </div>
            <button class="btn btn-sm btn-outline-danger" id="btn-task-delete-{{ t.id }}" onclick="deleteTask({{ t.id }})">Delete</button>
          </li>
          {% else %}
          <li class="list-group-item bg-black text-secondary" id="task-empty">No tasks yet.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
  </div>
  <div class="col-lg-6">
    <div class="card bg-black border-secondary h-100">
      <div class="card-body">
        <h3 class="h5" id="new-task-title">Add Task</h3>
        <form method="POST" id="form-task">
          {{ tform.hidden_tag() }}
          <div class="mb-3">
            <label for="task-title" class="form-label">Title</label>
            {{ tform.title(class="form-control", id="task-title") }}
          </div>
          <div class="mb-3">
            <label for="task-details" class="form-label">Details</label>
            {{ tform.details(class="form-control", id="task-details", rows="3") }}
          </div>
          <div class="mb-3">
            <label for="task-priority" class="form-label">Priority</label>
            {{ tform.priority(class="form-select", id="task-priority") }}
          </div>
          <div class="form-check mb-3">
            {{ tform.done(class="form-check-input", id="task-done") }}
            <label class="form-check-label" for="task-done">Mark as done</label>
          </div>
          {{ tform.submit(class="btn btn-primary", id="btn-task-save") }}
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock %}
